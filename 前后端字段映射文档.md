# å‰åç«¯å­—æ®µæ˜ å°„å®Œæ•´æ–‡æ¡£

**ç”Ÿæˆæ—¥æœŸ**: 2025-11-18  
**é¡¹ç›®**: WSNç‰›èˆç›‘æµ‹ç³»ç»Ÿ  
**åç«¯**: Spring Boot 2.7.18 + MyBatis  
**å‰ç«¯**: Vue 3 + TypeScript  
**æ•°æ®åº“**: MySQL 8.0+

---

## ğŸ“‹ æ˜ å°„è§„åˆ™è¯´æ˜

### å‘½åè§„èŒƒ
- **æ•°æ®åº“**: ä¸‹åˆ’çº¿å‘½å (snake_case) - å¦‚ `nh3_concentration`
- **Javaåç«¯**: é©¼å³°å‘½å (camelCase) - å¦‚ `nh3Concentration`
- **TypeScriptå‰ç«¯**: é©¼å³°å‘½å (camelCase) - å¦‚ `nh3Concentration`

### ç±»å‹æ˜ å°„
| æ•°æ®åº“ç±»å‹ | Javaç±»å‹ | TypeScriptç±»å‹ |
|-----------|----------|---------------|
| bigint | Long | number |
| int | Integer | number |
| varchar | String | string |
| decimal | Double | number |
| datetime | Date | string |
| timestamp | Date | string |
| tinyint | Integer | number |

### æ—¥æœŸæ ¼å¼
- **Java â†’ å‰ç«¯**: `yyyy-MM-dd HH:mm:ss`
- **å‰ç«¯ â†’ Java**: `yyyy-MM-dd HH:mm:ss`

---

## 1. SensorData (ä¼ æ„Ÿå™¨æ•°æ®)

### å­—æ®µæ˜ å°„å¯¹ç…§è¡¨

| æ•°æ®åº“å­—æ®µ | Javaå­—æ®µ | TSå­—æ®µ | æ•°æ®åº“ç±»å‹ | Javaç±»å‹ | TSç±»å‹ | è¯´æ˜ |
|-----------|---------|-------|----------|---------|-------|------|
| id | id | id | bigint | Long | number | ä¸»é”®ID |
| node_id | nodeId | nodeId | varchar(20) | String | string | âš ï¸ èŠ‚ç‚¹ID (String) |
| temperature | temperature | temperature | decimal(5,2) | Double | number | æ¸©åº¦(â„ƒ) |
| humidity | humidity | humidity | decimal(5,2) | Double | number | æ¹¿åº¦(%) |
| nh3_concentration | nh3Concentration | nh3Concentration | decimal(6,2) | Double | number | âš ï¸ æ°¨æ°”æµ“åº¦(ppm) |
| h2s_concentration | h2sConcentration | h2sConcentration | decimal(6,2) | Double | number | âš ï¸ ç¡«åŒ–æ°¢æµ“åº¦(ppm) |
| data_status | dataStatus | dataStatus | tinyint | Integer | number | æ•°æ®çŠ¶æ€(0-æ­£å¸¸,1-å¼‚å¸¸) |
| collect_time | collectTime | collectTime | datetime | Date | string | é‡‡é›†æ—¶é—´ |
| create_time | createTime | createTime | timestamp | Date | string | åˆ›å»ºæ—¶é—´ |

### âš ï¸ å…³é”®æ³¨æ„äº‹é¡¹
- âœ… `nodeId`æ˜¯**Stringç±»å‹**,ä¸æ˜¯number
- âœ… å­—æ®µåæ˜¯`nh3Concentration`,ä¸æ˜¯ammonia
- âœ… å­—æ®µåæ˜¯`h2sConcentration`,ä¸æ˜¯h2sæˆ–light
- âŒ æ•°æ®åº“ä¸­**æ²¡æœ‰**`ammonia`ã€`light`å­—æ®µ

### TypeScriptæ¥å£å®šä¹‰
```typescript
export interface SensorData {
  id: number
  nodeId: string                    // âš ï¸ Stringç±»å‹
  temperature: number
  humidity: number
  nh3Concentration: number          // âš ï¸ æ°¨æ°”æµ“åº¦
  h2sConcentration: number          // âš ï¸ ç¡«åŒ–æ°¢æµ“åº¦
  dataStatus: number
  collectTime: string
  createTime: string
}
```

---

## 2. NodeInfo (èŠ‚ç‚¹ä¿¡æ¯)

### å­—æ®µæ˜ å°„å¯¹ç…§è¡¨

| æ•°æ®åº“å­—æ®µ | Javaå­—æ®µ | TSå­—æ®µ | æ•°æ®åº“ç±»å‹ | Javaç±»å‹ | TSç±»å‹ | è¯´æ˜ |
|-----------|---------|-------|----------|---------|-------|------|
| id | id | id | int | Integer | number | ä¸»é”®ID |
| node_id | nodeId | nodeId | varchar(20) | String | string | âš ï¸ èŠ‚ç‚¹ID (String) |
| node_name | nodeName | nodeName | varchar(50) | String | string | èŠ‚ç‚¹åç§° |
| location | location | location | varchar(100) | String | string | å®‰è£…ä½ç½® |
| status | status | status | tinyint | Integer | number | âš ï¸ çŠ¶æ€(0-ç¦»çº¿,1-åœ¨çº¿,2-æ•…éšœ) |
| battery_level | batteryLevel | batteryLevel | int | Integer | number | ç”µæ± ç”µé‡(%) |
| signal_strength | signalStrength | signalStrength | int | Integer | number | ä¿¡å·å¼ºåº¦ |
| last_comm_time | lastCommTime | lastCommTime | datetime | Date | string | æœ€åé€šä¿¡æ—¶é—´ |
| install_date | installDate | installDate | date | Date | string | å®‰è£…æ—¥æœŸ |
| remark | remark | remark | varchar(200) | String | string | å¤‡æ³¨ |
| last_online_time | lastOnlineTime | lastOnlineTime | datetime | Date | string | æœ€ååœ¨çº¿æ—¶é—´ |
| create_time | createTime | createTime | timestamp | Date | string | åˆ›å»ºæ—¶é—´ |
| update_time | updateTime | updateTime | timestamp | Date | string | æ›´æ–°æ—¶é—´ |

### âš ï¸ å…³é”®æ³¨æ„äº‹é¡¹
- âœ… `nodeId`æ˜¯**Stringç±»å‹**,ä¸æ˜¯number
- âœ… çŠ¶æ€å­—æ®µåæ˜¯`status`,ä¸æ˜¯nodeStatus
- âŒ æ•°æ®åº“ä¸­**æ²¡æœ‰**`nodeType`å­—æ®µ

### TypeScriptæ¥å£å®šä¹‰
```typescript
export interface NodeInfo {
  id: number
  nodeId: string                    // âš ï¸ Stringç±»å‹
  nodeName: string
  location: string
  status: number                    // âš ï¸ çŠ¶æ€å­—æ®µå
  batteryLevel: number
  signalStrength: number
  lastCommTime: string
  installDate: string
  remark: string
  lastOnlineTime: string
  createTime: string
  updateTime: string
}
```

---

## 3. AlarmRecord (å‘Šè­¦è®°å½•)

### å­—æ®µæ˜ å°„å¯¹ç…§è¡¨

| æ•°æ®åº“å­—æ®µ | Javaå­—æ®µ | TSå­—æ®µ | æ•°æ®åº“ç±»å‹ | Javaç±»å‹ | TSç±»å‹ | è¯´æ˜ |
|-----------|---------|-------|----------|---------|-------|------|
| id | id | id | bigint | Long | number | ä¸»é”®ID |
| node_id | nodeId | nodeId | varchar(20) | String | string | âš ï¸ èŠ‚ç‚¹ID (String) |
| alarm_type | alarmType | alarmType | varchar(20) | String | string | âš ï¸ å‘Šè­¦ç±»å‹ (String) |
| alarm_level | alarmLevel | alarmLevel | tinyint | Integer | number | å‘Šè­¦çº§åˆ«(1-ä¸€èˆ¬,2-ä¸¥é‡,3-ç´§æ€¥) |
| current_value | currentValue | currentValue | decimal(6,2) | Double | number | å½“å‰å€¼ |
| threshold_value | threshold | threshold | decimal(6,2) | Double | number | é˜ˆå€¼ |
| alarm_time | alarmTime | alarmTime | datetime | Date | string | å‘Šè­¦æ—¶é—´ |
| status | handleStatus | handleStatus | tinyint | Integer | number | âš ï¸ å¤„ç†çŠ¶æ€(0-æœªå¤„ç†,1-å·²å¤„ç†) |
| handle_time | handleTime | handleTime | datetime | Date | string | å¤„ç†æ—¶é—´ |
| remark | handleRemark | handleRemark | varchar(200) | String | string | å¤„ç†å¤‡æ³¨ |

### âš ï¸ å…³é”®æ³¨æ„äº‹é¡¹
- âœ… `nodeId`æ˜¯**Stringç±»å‹**,ä¸æ˜¯number
- âœ… `alarmType`æ˜¯**Stringç±»å‹** (TEMP/HUMI/NH3/H2S),ä¸æ˜¯number
- âœ… çŠ¶æ€å­—æ®µåæ˜¯`handleStatus`,ä¸æ˜¯alarmStatus
- âŒ æ•°æ®åº“ä¸­**æ²¡æœ‰**`alarmContent`å­—æ®µ(éœ€å‰ç«¯æ ¹æ®alarmType/currentValue/thresholdåŠ¨æ€ç”Ÿæˆ)

### å‘Šè­¦ç±»å‹æšä¸¾
```typescript
enum AlarmType {
  TEMP = 'TEMP',      // æ¸©åº¦å‘Šè­¦
  HUMI = 'HUMI',      // æ¹¿åº¦å‘Šè­¦
  NH3 = 'NH3',        // æ°¨æ°”å‘Šè­¦
  H2S = 'H2S'         // ç¡«åŒ–æ°¢å‘Šè­¦
}
```

### TypeScriptæ¥å£å®šä¹‰
```typescript
export interface AlarmInfo {
  id: number
  nodeId: string                    // âš ï¸ Stringç±»å‹
  alarmType: string                 // âš ï¸ Stringç±»å‹: TEMP/HUMI/NH3/H2S
  alarmLevel: number
  currentValue: number              // âš ï¸ å½“å‰å€¼
  threshold: number                 // âš ï¸ é˜ˆå€¼
  alarmTime: string
  handleStatus: number              // âš ï¸ å¤„ç†çŠ¶æ€å­—æ®µå
  handleTime?: string
  handleRemark?: string
}
```

---

## 4. DeviceInfo (è®¾å¤‡ä¿¡æ¯)

### å­—æ®µæ˜ å°„å¯¹ç…§è¡¨

| æ•°æ®åº“å­—æ®µ | Javaå­—æ®µ | TSå­—æ®µ | æ•°æ®åº“ç±»å‹ | Javaç±»å‹ | TSç±»å‹ | è¯´æ˜ |
|-----------|---------|-------|----------|---------|-------|------|
| id | id | id | int | Integer | number | ä¸»é”®ID |
| device_id | deviceId | deviceId | varchar(20) | String | string | âš ï¸ è®¾å¤‡ID (String) |
| device_name | deviceName | deviceName | varchar(50) | String | string | è®¾å¤‡åç§° |
| device_type | deviceType | deviceType | varchar(20) | String | string | âš ï¸ è®¾å¤‡ç±»å‹ (String) |
| status | status | status | tinyint | Integer | number | âš ï¸ è®¾å¤‡çŠ¶æ€(0-å…³é—­,1-è¿è¡Œ) |
| auto_mode | autoMode | autoMode | int | Integer | number | âš ï¸ è‡ªåŠ¨æ¨¡å¼(0-æ‰‹åŠ¨,1-è‡ªåŠ¨) |
| control_mode | controlMode | controlMode | tinyint | Integer | number | æ§åˆ¶æ¨¡å¼ |
| create_time | createTime | createTime | timestamp | Date | string | åˆ›å»ºæ—¶é—´ |
| update_time | updateTime | updateTime | timestamp | Date | string | æ›´æ–°æ—¶é—´ |

### âš ï¸ å…³é”®æ³¨æ„äº‹é¡¹
- âœ… `deviceId`æ˜¯**Stringç±»å‹**,ä¸æ˜¯number
- âœ… `deviceType`æ˜¯**Stringç±»å‹** (FAN/CURTAIN/HEATING/SPRAY),ä¸æ˜¯number
- âœ… çŠ¶æ€å­—æ®µåæ˜¯`status`,ä¸æ˜¯deviceStatus
- âœ… **æœ‰**`autoMode`å­—æ®µ (0-æ‰‹åŠ¨,1-è‡ªåŠ¨)
- âŒ æ•°æ®åº“ä¸­**æ²¡æœ‰**`nodeId`å­—æ®µ

### è®¾å¤‡ç±»å‹æšä¸¾
```typescript
enum DeviceType {
  FAN = 'FAN',            // é£æœº
  CURTAIN = 'CURTAIN',    // å·å¸˜
  HEATING = 'HEATING',    // åŠ çƒ­
  SPRAY = 'SPRAY'         // å–·æ·‹
}
```

### TypeScriptæ¥å£å®šä¹‰
```typescript
export interface DeviceInfo {
  id: number
  deviceId: string                  // âš ï¸ Stringç±»å‹
  deviceName: string
  deviceType: string                // âš ï¸ Stringç±»å‹: FAN/CURTAIN/HEATING/SPRAY
  status: number                    // âš ï¸ çŠ¶æ€å­—æ®µå
  autoMode: number                  // âš ï¸ è‡ªåŠ¨æ¨¡å¼: 0-æ‰‹åŠ¨, 1-è‡ªåŠ¨
  controlMode: number
  createTime: string
  updateTime: string
}
```

---

## 5. DeviceControlLog (è®¾å¤‡æ§åˆ¶æ—¥å¿—)

### å­—æ®µæ˜ å°„å¯¹ç…§è¡¨

| æ•°æ®åº“å­—æ®µ | Javaå­—æ®µ | TSå­—æ®µ | æ•°æ®åº“ç±»å‹ | Javaç±»å‹ | TSç±»å‹ | è¯´æ˜ |
|-----------|---------|-------|----------|---------|-------|------|
| id | id | id | bigint | Long | number | ä¸»é”®ID |
| device_id | deviceId | deviceId | varchar(20) | String | string | âš ï¸ è®¾å¤‡ID (String) |
| control_action | controlAction | controlAction | varchar(10) | String | string | âš ï¸ æ§åˆ¶åŠ¨ä½œ (String) |
| control_mode | controlMode | controlMode | tinyint | Integer | number | æ§åˆ¶æ¨¡å¼(0-æ‰‹åŠ¨,1-è‡ªåŠ¨) |
| operator | operator | operator | varchar(50) | String | string | æ“ä½œäºº |
| control_time | controlTime | controlTime | datetime | Date | string | âš ï¸ æ§åˆ¶æ—¶é—´ |
| reason | reason | reason | varchar(200) | String | string | åŸå› /å¤‡æ³¨ |

### âš ï¸ å…³é”®æ³¨æ„äº‹é¡¹
- âœ… `deviceId`æ˜¯**Stringç±»å‹**,ä¸æ˜¯number
- âœ… åŠ¨ä½œå­—æ®µåæ˜¯`controlAction`,ä¸æ˜¯action
- âœ… æ—¶é—´å­—æ®µåæ˜¯`controlTime`,ä¸æ˜¯operateTime
- âŒ æ•°æ®åº“ä¸­**æ²¡æœ‰**`before_status`å’Œ`after_status`å­—æ®µ

### æ§åˆ¶åŠ¨ä½œæšä¸¾
```typescript
enum ControlAction {
  START = 'START',        // å¯åŠ¨
  STOP = 'STOP',          // åœæ­¢
  ADJUST = 'ADJUST'       // è°ƒèŠ‚
}
```

### TypeScriptæ¥å£å®šä¹‰
```typescript
export interface DeviceControlLog {
  id: number
  deviceId: string                  // âš ï¸ Stringç±»å‹
  controlAction: string             // âš ï¸ æ§åˆ¶åŠ¨ä½œ: START/STOP/ADJUST
  controlMode: number               // âš ï¸ æ§åˆ¶æ¨¡å¼: 0-æ‰‹åŠ¨, 1-è‡ªåŠ¨
  operator: string
  controlTime: string
  reason: string
}
```

---

## 6. SystemConfig (ç³»ç»Ÿé…ç½®)

### å­—æ®µæ˜ å°„å¯¹ç…§è¡¨

| æ•°æ®åº“å­—æ®µ | Javaå­—æ®µ | TSå­—æ®µ | æ•°æ®åº“ç±»å‹ | Javaç±»å‹ | TSç±»å‹ | è¯´æ˜ |
|-----------|---------|-------|----------|---------|-------|------|
| id | id | id | int | Integer | number | ä¸»é”®ID |
| config_key | configKey | configKey | varchar(50) | String | string | é…ç½®é”® |
| config_value | configValue | configValue | varchar(200) | String | string | é…ç½®å€¼ |
| description | description | description | varchar(200) | String | string | âš ï¸ é…ç½®è¯´æ˜ |
| config_type | configType | configType | varchar(20) | String | string | é…ç½®ç±»å‹ |
| create_time | createTime | createTime | timestamp | Date | string | åˆ›å»ºæ—¶é—´ |
| update_time | updateTime | updateTime | timestamp | Date | string | æ›´æ–°æ—¶é—´ |

### âš ï¸ å…³é”®æ³¨æ„äº‹é¡¹
- âœ… è¯´æ˜å­—æ®µåæ˜¯`description`,ä¸æ˜¯configDesc

### TypeScriptæ¥å£å®šä¹‰
```typescript
export interface SystemConfig {
  id: number
  configKey: string
  configValue: string
  description: string               // âš ï¸ å­—æ®µå
  configType: string
  createTime: string
  updateTime: string
}
```

---

## 7. ç»Ÿä¸€å“åº”ç»“æ„

### Result<T> - åç«¯ç»Ÿä¸€è¿”å›ç»“æœ

**Javaç±»**: `com.wsn.cow.common.Result<T>`

| Javaå­—æ®µ | TSå­—æ®µ | Javaç±»å‹ | TSç±»å‹ | è¯´æ˜ |
|---------|-------|---------|-------|------|
| code | code | Integer | number | çŠ¶æ€ç  |
| message | message | String | string | è¿”å›æ¶ˆæ¯ |
| data | data | T | T | è¿”å›æ•°æ® |
| timestamp | timestamp | Long | number | æ—¶é—´æˆ³ |

### TypeScriptæ¥å£å®šä¹‰
```typescript
export interface ApiResponse<T = any> {
  code: number
  message: string
  data: T
  timestamp: number
}
```

### PageResult - åˆ†é¡µç»“æœ

| Javaå­—æ®µ | TSå­—æ®µ | Javaç±»å‹ | TSç±»å‹ | è¯´æ˜ |
|---------|-------|---------|-------|------|
| records | records | List<T> | T[] | å½“å‰é¡µæ•°æ® |
| total | total | Long | number | æ€»è®°å½•æ•° |
| size | size | Integer | number | æ¯é¡µå¤§å° |
| current | current | Integer | number | å½“å‰é¡µç  |
| pages | pages | Integer | number | æ€»é¡µæ•° |

### TypeScriptæ¥å£å®šä¹‰
```typescript
export interface PageResult<T> {
  records: T[]
  total: number
  size: number
  current: number
  pages: number
}

export interface PageParams {
  pageNum: number
  pageSize: number
}
```

---

## 8. APIæ¥å£å‚æ•°æ˜ å°„

### 8.1 ä¼ æ„Ÿå™¨æ•°æ®æ¥å£

#### GET /api/sensor/latest
- **è¯·æ±‚å‚æ•°**: æ— 
- **è¿”å›**: `Result<List<SensorData>>`

#### GET /api/sensor/data/{nodeId}
- **è·¯å¾„å‚æ•°**: 
  - `nodeId`: String (âš ï¸ æ³¨æ„ç±»å‹)
- **è¿”å›**: `Result<SensorData>`

#### GET /api/sensor/history
- **æŸ¥è¯¢å‚æ•°**:
  - `nodeId`: String (å¯é€‰)
  - `startTime`: String (å¯é€‰, æ ¼å¼: yyyy-MM-dd HH:mm:ss)
  - `endTime`: String (å¯é€‰)
  - `pageNum`: Integer (å¯é€‰, é»˜è®¤1)
  - `pageSize`: Integer (å¯é€‰, é»˜è®¤10)
- **è¿”å›**: `Result<PageResult<SensorData>>`

---

### 8.2 èŠ‚ç‚¹ç®¡ç†æ¥å£

#### GET /api/node/list
- **æŸ¥è¯¢å‚æ•°**:
  - `pageNum`: Integer (é»˜è®¤1)
  - `pageSize`: Integer (é»˜è®¤10)
- **è¿”å›**: `Result<List<NodeInfo>>`

#### GET /api/node/all
- **è¯·æ±‚å‚æ•°**: æ— 
- **è¿”å›**: `Result<List<NodeInfo>>`

#### GET /api/node/{nodeId}
- **è·¯å¾„å‚æ•°**: 
  - `nodeId`: String (âš ï¸ æ³¨æ„ç±»å‹)
- **è¿”å›**: `Result<NodeInfo>`

#### POST /api/node
- **è¯·æ±‚ä½“**: `NodeInfo`
- **è¿”å›**: `Result<String>`

#### PUT /api/node/{nodeId}
- **è·¯å¾„å‚æ•°**: `nodeId`: String
- **è¯·æ±‚ä½“**: `NodeInfo`
- **è¿”å›**: `Result<String>`

---

### 8.3 å‘Šè­¦ç®¡ç†æ¥å£

#### GET /api/alarm/list
- **æŸ¥è¯¢å‚æ•°**:
  - `nodeId`: String (å¯é€‰)
  - `alarmType`: String (å¯é€‰, TEMP/HUMI/NH3/H2S)
  - `alarmLevel`: Integer (å¯é€‰, 1/2/3)
  - `handleStatus`: Integer (å¯é€‰, 0/1) âš ï¸ æ³¨æ„å­—æ®µå
  - `startTime`: String (å¯é€‰)
  - `endTime`: String (å¯é€‰)
  - `pageNum`: Integer (é»˜è®¤1)
  - `pageSize`: Integer (é»˜è®¤10)
- **è¿”å›**: `Result<PageResult<AlarmRecord>>`

#### PUT /api/alarm/handle/{id}
- **è·¯å¾„å‚æ•°**: `id`: Long
- **æŸ¥è¯¢å‚æ•°**:
  - `handleStatus`: Integer (é»˜è®¤1)
  - `handleRemark`: String (å¯é€‰)
- **è¿”å›**: `Result<String>`

#### PUT /api/alarm/handle/batch
- **æŸ¥è¯¢å‚æ•°**:
  - `ids`: String (é€—å·åˆ†éš”çš„IDåˆ—è¡¨)
  - `handleStatus`: Integer (é»˜è®¤1)
  - `handleRemark`: String (å¯é€‰)
- **è¿”å›**: `Result<String>`

---

### 8.4 è®¾å¤‡æ§åˆ¶æ¥å£

#### GET /api/device/list
- **æŸ¥è¯¢å‚æ•°**:
  - `deviceType`: String (å¯é€‰, FAN/CURTAIN/HEATING/SPRAY)
- **è¿”å›**: `Result<List<DeviceInfo>>`

#### POST /api/device/control
- **è¯·æ±‚ä½“**:
```json
{
  "deviceId": "DEV001",
  "action": "START",      // âš ï¸ STARTæˆ–STOP
  "operator": "Admin"
}
```
- **è¿”å›**: `Result<String>`

#### PUT /api/device/{deviceId}/mode
- **è·¯å¾„å‚æ•°**: `deviceId`: String
- **è¯·æ±‚ä½“**:
```json
{
  "autoMode": 1           // âš ï¸ 0-æ‰‹åŠ¨, 1-è‡ªåŠ¨
}
```
- **è¿”å›**: `Result<String>`

---

### 8.5 ç³»ç»Ÿé…ç½®æ¥å£

#### GET /api/config/list
- **è¯·æ±‚å‚æ•°**: æ— 
- **è¿”å›**: `Result<List<SystemConfig>>`

#### GET /api/config/{key}
- **è·¯å¾„å‚æ•°**: `key`: String
- **è¿”å›**: `Result<String>` (âš ï¸ ç›´æ¥è¿”å›valueå­—ç¬¦ä¸²)

#### PUT /api/config/{key}
- **è·¯å¾„å‚æ•°**: `key`: String
- **æŸ¥è¯¢å‚æ•°**: `value`: String
- **è¿”å›**: `Result<String>`

#### PUT /api/config/batch
- **è¯·æ±‚ä½“**: `Map<String, String>`
```json
{
  "TEMP_THRESHOLD_1": "30",
  "TEMP_THRESHOLD_2": "35"
}
```
- **è¿”å›**: `Result<String>`

---

## 9. å¸¸è§é”™è¯¯å¯¹ç…§è¡¨

| âŒ é”™è¯¯ç”¨æ³• | âœ… æ­£ç¡®ç”¨æ³• | æ‰€å±å®ä½“ |
|-----------|-----------|---------|
| nodeId: number | nodeId: string | SensorData, NodeInfo, AlarmInfo |
| ammonia | nh3Concentration | SensorData |
| light | h2sConcentration | SensorData |
| nodeStatus | status | NodeInfo |
| alarmStatus | handleStatus | AlarmInfo |
| alarmContent | currentValue + threshold (åŠ¨æ€ç”Ÿæˆ) | AlarmInfo |
| alarmType: number | alarmType: string | AlarmInfo |
| deviceStatus | status | DeviceInfo |
| deviceType: number | deviceType: string | DeviceInfo |
| action | controlAction | DeviceControlLog |
| operateTime | controlTime | DeviceControlLog |
| configDesc | description | SystemConfig |

---

## 10. å‰ç«¯è°ƒç”¨ç¤ºä¾‹

### 10.1 ä¼ æ„Ÿå™¨æ•°æ®æŸ¥è¯¢
```typescript
import { getLatestSensorData, getSensorDataByNode } from '@/api/sensor'

// è·å–æ‰€æœ‰æœ€æ–°æ•°æ®
const latestData = await getLatestSensorData()

// è·å–æŒ‡å®šèŠ‚ç‚¹æ•°æ® (æ³¨æ„nodeIdæ˜¯string)
const nodeData = await getSensorDataByNode('NODE001')

// è®¿é—®æ°¨æ°”æµ“åº¦ (æ³¨æ„å­—æ®µå)
console.log(nodeData.nh3Concentration)  // âœ… æ­£ç¡®
// console.log(nodeData.ammonia)        // âŒ é”™è¯¯
```

### 10.2 èŠ‚ç‚¹çŠ¶æ€æŸ¥è¯¢
```typescript
import { getAllNodes, getNodeStatusStats } from '@/api/node'

// è·å–æ‰€æœ‰èŠ‚ç‚¹
const nodes = await getAllNodes()

// è®¿é—®èŠ‚ç‚¹çŠ¶æ€ (æ³¨æ„å­—æ®µå)
nodes.forEach(node => {
  console.log(node.status)      // âœ… æ­£ç¡®
  // console.log(node.nodeStatus)  // âŒ é”™è¯¯
})

// è·å–çŠ¶æ€ç»Ÿè®¡
const stats = await getNodeStatusStats()
console.log(`åœ¨çº¿: ${stats.online}, ç¦»çº¿: ${stats.offline}`)
```

### 10.3 å‘Šè­¦å¤„ç†
```typescript
import { getAlarmList, handleAlarm } from '@/api/alarm'

// æŸ¥è¯¢æœªå¤„ç†å‘Šè­¦ (æ³¨æ„å­—æ®µå)
const alarms = await getAlarmList({
  pageNum: 1,
  pageSize: 10,
  handleStatus: 0  // âœ… æ­£ç¡®
  // alarmStatus: 0   // âŒ é”™è¯¯
})

// å¤„ç†å‘Šè­¦
await handleAlarm(123, 'å·²ç¡®è®¤å¤„ç†')

// è®¿é—®å‘Šè­¦ç±»å‹ (æ³¨æ„æ˜¯string)
alarms.records.forEach(alarm => {
  if (alarm.alarmType === 'TEMP') {  // âœ… æ­£ç¡®
    console.log(`æ¸©åº¦å‘Šè­¦: ${alarm.currentValue}â„ƒ`)
  }
})
```

### 10.4 è®¾å¤‡æ§åˆ¶
```typescript
import { controlDevice, switchDeviceMode } from '@/api/device'

// æ§åˆ¶è®¾å¤‡ (æ³¨æ„deviceIdæ˜¯string, actionæ˜¯START/STOP)
await controlDevice({
  deviceId: 'DEV001',  // âœ… stringç±»å‹
  action: 'START',     // âœ… STARTæˆ–STOP
  operator: 'Admin'
})

// åˆ‡æ¢æ¨¡å¼ (æ³¨æ„autoMode: 0-æ‰‹åŠ¨, 1-è‡ªåŠ¨)
await switchDeviceMode('DEV001', 1)
```

---

## 11. æ•°æ®è½¬æ¢å·¥å…·å‡½æ•°

### 11.1 å‘Šè­¦å†…å®¹ç”Ÿæˆ
```typescript
/**
 * æ ¹æ®å‘Šè­¦ä¿¡æ¯ç”Ÿæˆå‘Šè­¦å†…å®¹æ–‡æœ¬
 */
export function generateAlarmContent(alarm: AlarmInfo): string {
  const typeMap: Record<string, string> = {
    TEMP: 'æ¸©åº¦',
    HUMI: 'æ¹¿åº¦',
    NH3: 'æ°¨æ°”æµ“åº¦',
    H2S: 'ç¡«åŒ–æ°¢æµ“åº¦'
  }
  
  const typeName = typeMap[alarm.alarmType] || 'æœªçŸ¥'
  const unit = alarm.alarmType === 'TEMP' ? 'â„ƒ' : 
               alarm.alarmType === 'HUMI' ? '%' : 'ppm'
  
  return `${typeName}è¶…æ ‡: å½“å‰å€¼${alarm.currentValue}${unit}, é˜ˆå€¼${alarm.threshold}${unit}`
}
```

### 11.2 æ—¥æœŸæ ¼å¼è½¬æ¢
```typescript
import dayjs from 'dayjs'

/**
 * æ ¼å¼åŒ–æ—¥æœŸæ—¶é—´
 */
export function formatDateTime(date: string | Date): string {
  return dayjs(date).format('YYYY-MM-DD HH:mm:ss')
}

/**
 * æ ¼å¼åŒ–æ—¥æœŸ
 */
export function formatDate(date: string | Date): string {
  return dayjs(date).format('YYYY-MM-DD')
}
```

### 11.3 çŠ¶æ€æ–‡æœ¬è½¬æ¢
```typescript
/**
 * è·å–èŠ‚ç‚¹çŠ¶æ€æ–‡æœ¬
 */
export function getNodeStatusText(status: number): string {
  const map: Record<number, string> = {
    0: 'ç¦»çº¿',
    1: 'åœ¨çº¿',
    2: 'æ•…éšœ'
  }
  return map[status] || 'æœªçŸ¥'
}

/**
 * è·å–è®¾å¤‡çŠ¶æ€æ–‡æœ¬
 */
export function getDeviceStatusText(status: number): string {
  return status === 1 ? 'è¿è¡Œä¸­' : 'å·²åœæ­¢'
}

/**
 * è·å–æ§åˆ¶æ¨¡å¼æ–‡æœ¬
 */
export function getAutoModeText(autoMode: number): string {
  return autoMode === 1 ? 'è‡ªåŠ¨æ¨¡å¼' : 'æ‰‹åŠ¨æ¨¡å¼'
}
```

---

## 12. æµ‹è¯•æ£€æŸ¥æ¸…å•

### âœ… åç«¯æ£€æŸ¥
- [x] å®ä½“ç±»å­—æ®µåä¸æ•°æ®åº“ä¸€è‡´
- [x] Mapper XML resultMapæ˜ å°„æ­£ç¡®
- [x] Controlleræ¥å£è·¯å¾„è§„èŒƒ
- [x] Serviceä¸šåŠ¡é€»è¾‘å®Œæ•´

### âœ… å‰ç«¯æ£€æŸ¥
- [x] TypeScriptæ¥å£å®šä¹‰ä¸åç«¯ä¸€è‡´
- [x] APIå‡½æ•°å‚æ•°ç±»å‹æ­£ç¡®
- [x] ç»„ä»¶Propsç±»å‹åŒ¹é…
- [x] HTTPè¯·æ±‚è·¯å¾„æ­£ç¡®

### ğŸ”„ è”è°ƒæµ‹è¯•
- [ ] ä¼ æ„Ÿå™¨æ•°æ®æŸ¥è¯¢æ¥å£
- [ ] èŠ‚ç‚¹ç®¡ç†CRUDæ¥å£
- [ ] å‘Šè­¦åˆ—è¡¨ä¸å¤„ç†æ¥å£
- [ ] è®¾å¤‡æ§åˆ¶æ¥å£
- [ ] ç³»ç»Ÿé…ç½®æ¥å£

---

**æ–‡æ¡£ç»´æŠ¤**: å¼€å‘å›¢é˜Ÿ  
**æœ€åæ›´æ–°**: 2025-11-18  
**çŠ¶æ€**: âœ… å·²éªŒè¯æ‰€æœ‰æ˜ å°„æ­£ç¡®æ€§
