# 智能牛棚环境监测系统 - 两周开发任务计划

## 项目信息
- **项目名称**：基于ZigBee无线传感器网络的智能牛棚环境监测系统
- **开发周期**：2周（10个工作日）
- **开发模式**：全栈开发（后端 + 前端 + 模拟器）
- **计划制定日期**：2025年11月17日

---

## 📅 第一周：基础架构 + 核心功能开发

### Day 1 (2025-11-18 周一) - 环境搭建与数据库初始化

#### 上午任务 (4小时)
- [x] **任务1.1：开发环境配置**
  - 安装并配置JDK 21
  - 安装MySQL 8.0+，创建数据库 `wsn_cow_monitor`
  - 安装Node.js LTS版本
  - 安装Python 3.x
  - 安装Maven 3.6+
  - 配置IDE（IntelliJ IDEA / Eclipse）

- [x] **任务1.2：数据库设计与初始化**
  - 创建数据库初始化SQL脚本 `init.sql`
  - 创建7张核心数据表：
    - `sensor_data` - 传感器数据表
    - `node_info` - 节点信息表
    - `alarm_record` - 告警记录表
    - `device_info` - 设备信息表
    - `device_control_log` - 设备控制日志表
    - `system_config` - 系统配置表
    - `user` - 用户表
  - 创建索引（node_id, collect_time, alarm_time等）
  - 插入初始化数据（3个节点、3个设备、系统配置）

#### 下午任务 (4小时)
- [x] **任务1.3：后端项目框架搭建**
  - 创建Maven项目，配置pom.xml
  - 添加依赖：Spring、Spring MVC、MyBatis、MySQL驱动、Lombok、Jackson等
  - 配置项目结构：
    ```
    src/main/java
      ├── com.wsn.cow
      │   ├── controller    # 控制器层
      │   ├── service       # 业务逻辑层
      │   ├── mapper        # 数据访问层
      │   ├── entity        # 实体类
      │   ├── dto           # 数据传输对象
      │   ├── vo            # 视图对象
      │   ├── common        # 公共类（结果封装、常量等）
      │   ├── config        # 配置类
      │   └── util          # 工具类
    src/main/resources
      ├── mapper            # MyBatis XML映射文件
      ├── application.yml   # 配置文件
      └── logback.xml       # 日志配置
    ```
  - 配置Spring MVC、MyBatis、数据源（HikariCP）
  - 配置跨域CORS、统一异常处理
  - 测试数据库连接

#### 晚上任务 (2小时) - 可选
- [x] **任务1.4：Git仓库初始化**
  - 初始化Git仓库
  - 创建`.gitignore`文件
  - 编写项目README.md
  - 完成第一次提交

---

### Day 2 (2025-11-19 周二) - Python传感器模拟器开发

#### 上午任务 (4小时)
- [x] **任务2.1：模拟器项目结构搭建**
  - 创建Python项目目录 `sensor_simulator`
  - 项目结构：
    ```
    sensor_simulator/
      ├── main.py              # 主程序入口
      ├── config.py            # 配置文件
      ├── data_generator.py    # 数据生成模块
      ├── zigbee_simulator.py  # ZigBee通信模拟
      ├── serial_comm.py       # 串口通信模块
      ├── device_controller.py # 设备控制模块
      ├── logger.py            # 日志模块
      └── requirements.txt     # 依赖包
    ```
  - 安装依赖：`pyserial`, `numpy`, `pyyaml`

- [x] **任务2.2：数据生成算法实现**
  - 实现 `SensorDataGenerator` 类
  - 实现正常模式数据生成：
    - 温度：基准20°C + 正弦波动 + 高斯噪声
    - 湿度：基准60% + 随机波动（±5%）
    - 氨气：基准5ppm + 随机波动（0-10ppm）
    - 硫化氢：基准2ppm + 随机波动（0-5ppm）
  - 实现异常模式数据生成
  - 实现多节点数据生成（3个节点）

#### 下午任务 (4小时)
- [x] **任务2.3：ZigBee协议模拟与串口通信**
  - 设计数据包格式：
    ```
    0xAA [NodeID] [Len] [Temp_H] [Temp_L] [Humi_H] [Humi_L] 
    [NH3_H] [NH3_L] [H2S_H] [H2S_L] [CheckSum] 0x55
    ```
  - 实现数据包封装函数
  - 实现校验和计算（CRC8/简单累加）
  - 实现串口通信（优先考虑Socket通信作为虚拟串口）
  - 配置通信参数（端口、波特率115200）

- [x] **任务2.4：配置文件与测试**
  - 创建配置文件 `config.yaml`：
    - 节点配置（ID、位置、采集周期）
    - 通信配置（串口/Socket、波特率）
    - 数据生成模式（正常/异常）
  - 编写测试脚本，验证数据生成
  - 测试数据包发送功能

---

### Day 3 (2025-11-20 周三) - 后端数据接收与存储

#### 上午任务 (4小时)
- [x] **任务3.1：实体类与Mapper开发**
  - 创建实体类：
    - `SensorData.java` - 传感器数据
    - `NodeInfo.java` - 节点信息
    - `AlarmRecord.java` - 告警记录
    - `DeviceInfo.java` - 设备信息
    - `DeviceControlLog.java` - 控制日志
    - `SystemConfig.java` - 系统配置
  - 创建对应的Mapper接口和XML文件
  - 实现基础CRUD方法
  - 编写单元测试验证Mapper

- [x] **任务3.2：公共类与工具类**
  - 创建统一返回结果类 `Result<T>`
  - 创建分页结果类 `PageResult<T>`
  - 创建常量类 `Constants`（告警阈值、设备类型等）
  - 创建日期工具类 `DateUtils`
  - 创建数据校验工具类 `ValidationUtils`

#### 下午任务 (4小时)
- [x] **任务3.3：串口数据接收服务**
  - 创建 `SerialDataReceiver` 服务（或`SocketDataReceiver`）
  - 实现Socket服务器监听（端口：8888）
  - 实现数据接收与解析：
    - 帧头帧尾验证
    - 数据包解析（提取节点ID、传感器数据）
    - 校验和验证
    - 数据有效性检查
  - 实现异常处理（超时、格式错误、校验失败）
  - 使用Spring `@PostConstruct` 启动接收服务

- [x] **任务3.4：数据存储Service开发**
  - 创建 `SensorDataService` 接口和实现类
  - 实现数据保存方法（批量插入优化）
  - 实现最新数据查询
  - 实现历史数据查询（分页、时间筛选）
  - 创建 `NodeInfoService` 更新节点在线状态
  - 测试数据接收、解析、存储流程

---

### Day 4 (2025-11-21 周四) - 告警模块开发

#### 上午任务 (4小时)
- [x] **任务4.1：告警规则配置**
  - 创建 `AlarmRule` 类，定义告警阈值
  - 将默认阈值存入 `system_config` 表：
    - `alarm.nh3.warning = 25`
    - `alarm.nh3.critical = 40`
    - `alarm.h2s.warning = 10`
    - `alarm.h2s.critical = 20`
    - `alarm.temp.low.warning = 5`
    - `alarm.temp.high.warning = 35`
    - `alarm.humidity.low = 30`
    - `alarm.humidity.high = 85`
  - 创建 `AlarmConfigService` 读取配置

- [x] **任务4.2：告警判断与触发逻辑**
  - 创建 `AlarmService` 接口和实现类
  - 实现告警判断方法 `checkAlarm(SensorData data)`
  - 实现告警级别判定（警告/严重/紧急）
  - 实现告警去重逻辑（10分钟内不重复）
  - 实现告警记录保存
  - 集成到数据接收流程中

#### 下午任务 (4小时)
- [x] **任务4.3：告警管理接口开发**
  - 创建 `AlarmController`
  - 实现接口：
    - `GET /api/alarm/list` - 告警列表（分页、筛选）
    - `GET /api/alarm/unhandled` - 未处理告警
    - `PUT /api/alarm/handle/{alarmId}` - 处理告警
    - `GET /api/alarm/statistics` - 告警统计
  - 编写Service层业务逻辑
  - 使用Postman测试接口

- [x] **任务4.4：WebSocket实时推送基础搭建**
  - 添加WebSocket依赖（Spring WebSocket）
  - 创建WebSocket配置类 `WebSocketConfig`
  - 创建 `AlarmWebSocketHandler` 处理器
  - 实现告警实时推送功能
  - 测试WebSocket连接与消息推送

---

### Day 5 (2025-11-22 周五) - 设备控制与传感器数据接口

#### 上午任务 (4小时)
- [x] **任务5.1：设备控制Service开发**
  - 创建 `DeviceControlService` 接口和实现类
  - 实现自动控制策略：
    - `checkAndControlByNH3()` - 氨气超标启动风机
    - `checkAndControlByH2S()` - 硫化氢超标启动风机
    - `checkAndControlByTemperature()` - 温度异常控制卷帘/供热
  - 实现手动控制方法 `manualControl()`
  - 实现设备状态查询
  - 集成到数据接收流程（自动控制）

- [x] **任务5.2：设备控制接口开发**
  - 创建 `DeviceController`
  - 实现接口：
    - `GET /api/device/list` - 设备列表
    - `GET /api/device/{deviceId}` - 设备状态
    - `POST /api/device/control` - 控制设备
    - `GET /api/device/log` - 控制日志
  - 实现设备控制日志记录
  - 模拟器增加控制指令接收功能（Socket反向通信）

#### 下午任务 (4小时)
- [x] **任务5.3：传感器数据接口开发**
  - 创建 `SensorDataController`
  - 实现接口：
    - `GET /api/sensor/latest` - 所有节点最新数据
    - `GET /api/sensor/history` - 历史数据（分页）
    - `GET /api/sensor/data/{nodeId}` - 指定节点最新数据
  - 优化查询性能（索引、缓存）
  - 测试接口返回数据格式

- [x] **任务5.4：节点管理接口开发**
  - 创建 `NodeController`
  - 实现接口：
    - `GET /api/node/list` - 节点列表
    - `GET /api/node/{nodeId}` - 节点详情
    - `POST /api/node` - 添加节点
    - `PUT /api/node/{nodeId}` - 更新节点
    - `DELETE /api/node/{nodeId}` - 删除节点
  - 实现节点在线状态监测（定时任务，5分钟无数据标记离线）

---

## 📅 第二周：前端开发 + 系统集成测试

### Day 6 (2025-11-25 周一) - 前端项目初始化与布局

#### 上午任务 (4小时)
- [x] **任务6.1：Vue 3项目创建**
  - 使用 `npm create vue@latest` 创建项目
  - 选择配置：Vue 3 + TypeScript + Vue Router + Pinia + ESLint
  - 项目结构规划：
    ```
    src/
      ├── api/              # API接口封装
      ├── assets/           # 静态资源
      ├── components/       # 公共组件
      ├── views/            # 页面视图
      ├── router/           # 路由配置
      ├── stores/           # Pinia状态管理
      ├── utils/            # 工具函数
      ├── types/            # TypeScript类型定义
      └── App.vue
    ```
  - 安装依赖：Element Plus、ECharts、Axios、Day.js
  - 配置Axios拦截器（请求/响应处理）

- [x] **任务6.2：整体布局与路由设计**
  - 创建布局组件 `Layout.vue`（顶部导航 + 侧边栏 + 内容区）
  - 配置路由：
    - `/dashboard` - 实时监控首页
    - `/nodes` - 节点管理
    - `/alarms` - 告警管理
    - `/devices` - 设备控制
    - `/history` - 历史数据
    - `/settings` - 系统配置
  - 使用Element Plus设计导航菜单
  - 实现页面切换动画

#### 下午任务 (4小时)
- [x] **任务6.3：API接口封装**
  - 创建API模块：
    - `api/sensor.ts` - 传感器数据接口
    - `api/node.ts` - 节点管理接口
    - `api/alarm.ts` - 告警管理接口
    - `api/device.ts` - 设备控制接口
    - `api/config.ts` - 系统配置接口
  - 定义TypeScript接口类型
  - 实现请求错误统一处理

- [x] **任务6.4：公共组件开发**
  - 创建数据卡片组件 `DataCard.vue`（展示单个传感器数据）
  - 创建节点状态指示器 `NodeStatus.vue`（在线/离线）
  - 创建告警标签 `AlarmBadge.vue`（不同级别颜色）
  - 创建设备开关组件 `DeviceSwitch.vue`
  - 编写组件文档与示例

---

### Day 7 (2025-11-26 周二) - 实时监控首页开发

#### 上午任务 (4小时)
- [x] **任务7.1：首页布局与数据展示**
  - 创建 `Dashboard.vue` 页面
  - 顶部概览区域（4个统计卡片）：
    - 在线节点数 / 总节点数
    - 未处理告警数
    - 运行中设备数
    - 最近更新时间
  - 实现数据自动刷新（5秒/次）
  - 使用WebSocket接收实时数据

- [x] **任务7.2：节点位置分布展示**
  - 创建节点分布组件 `NodeDistribution.vue`
  - 使用Grid布局模拟牛棚平面图
  - 显示每个节点的位置、状态、实时数据
  - 实现节点点击查看详情

#### 下午任务 (4小时)
- [x] **任务7.3：实时数据图表（ECharts）**
  - 创建图表组件 `RealTimeChart.vue`
  - 实现4个仪表盘：
    - 平均温度仪表盘
    - 平均湿度仪表盘
    - 氨气浓度仪表盘
    - 硫化氢浓度仪表盘
  - 配置颜色阈值（正常/警告/危险）
  - 实现图表数据实时更新

- [x] **任务7.4：告警提示与WebSocket集成**
  - 创建告警通知组件 `AlarmNotification.vue`
  - 集成Element Plus的 `ElNotification`
  - 实现WebSocket客户端连接
  - 监听告警消息，显示弹窗 + 声音提示
  - 实现告警历史快速查看

---

### Day 8 (2025-11-27 周三) - 历史数据与图表分析

#### 上午任务 (4小时)
- [x] **任务8.1：历史数据查询页面**
  - 创建 `HistoryData.vue` 页面
  - 实现查询条件筛选：
    - 节点选择（下拉框）
    - 时间范围选择（快捷选项：1小时、6小时、24小时、7天、自定义）
    - 数据类型选择（温度、湿度、氨气、硫化氢）
  - 实现数据表格展示（分页）
  - 实现数据导出功能（CSV格式）

- [x] **任务8.2：历史数据折线图**
  - 创建 `HistoryChart.vue` 组件
  - 实现多条折线图（同时展示4种传感器数据）
  - 实现图例筛选（点击隐藏/显示某条曲线）
  - 实现数据缩放（DataZoom）
  - 实现tooltip展示详细数据

#### 下午任务 (4小时)
- [x] **任务8.3：数据统计与对比**
  - 创建统计卡片：显示选定时间范围内的：
    - 平均值
    - 最大值 / 最小值
    - 超标次数
    - 数据采集条数
  - 实现多节点数据对比柱状图
  - 实现数据趋势分析（同比、环比）

- [x] **任务8.4：节点详情页面**
  - 创建 `NodeDetail.vue` 页面
  - 展示节点基本信息（名称、位置、状态）
  - 展示该节点最近24小时数据曲线
  - 展示该节点告警历史
  - 提供节点配置编辑功能

---

### Day 9 (2025-11-28 周四) - 告警与设备管理页面

#### 上午任务 (4小时)
- [x] **任务9.1：告警管理页面**
  - 创建 `AlarmManagement.vue` 页面
  - 实现告警列表表格：
    - 显示告警时间、节点、类型、级别、当前值、状态
    - 支持筛选（状态、类型、级别、时间范围）
    - 支持分页
  - 实现告警处理功能：
    - 单条处理
    - 批量处理
    - 添加处理备注
  - 使用不同颜色标识告警级别（Tag组件）

- [x] **任务9.2：告警统计页面**
  - 创建告警统计图表：
    - 告警类型饼图
    - 告警趋势折线图（按天统计）
    - 节点告警排行榜（柱状图）
  - 实现时间范围筛选
  - 实现统计数据导出

#### 下午任务 (4小时)
- [x] **任务9.3：设备控制页面**
  - 创建 `DeviceControl.vue` 页面
  - 展示设备列表（卡片形式）：
    - 设备名称、类型、状态（开/关）
    - 控制模式（手动/自动）
    - 运行时长统计
  - 实现设备控制开关（Switch组件）
  - 实现控制模式切换
  - 实时显示设备状态（WebSocket）

- [x] **任务9.4：设备控制日志**
  - 创建控制日志表格
  - 显示控制时间、设备、动作、模式、操作者、原因
  - 支持时间筛选
  - 实现日志导出功能

---

### Day 10 (2025-11-29 周五) - 系统配置与联调测试

#### 上午任务 (4小时)
- [x] **任务10.1：系统配置页面**
  - 创建 `SystemSettings.vue` 页面
  - 实现告警阈值配置表单：
    - 氨气警告/严重阈值
    - 硫化氢警告/严重阈值
    - 温度上下限
    - 湿度上下限
  - 实现数据采集周期配置
  - 实现自动控制策略配置
  - 实现配置保存与重置

- [x] **任务10.2：节点管理页面**
  - 创建 `NodeManagement.vue` 页面
  - 实现节点列表表格（ID、名称、位置、状态、最后在线时间）
  - 实现节点添加对话框
  - 实现节点编辑功能
  - 实现节点删除（带确认）
  - 实现节点状态实时更新

#### 下午任务 (4小时)
- [x] **任务10.3：系统集成测试**
  - 启动Python模拟器（多节点、正常模式）
  - 启动后端服务
  - 启动前端开发服务器
  - 测试完整流程：
    1. 模拟器发送数据 → 后端接收 → 前端显示
    2. 模拟器触发异常数据 → 告警生成 → 前端弹窗
    3. 手动控制设备 → 后端处理 → 模拟器响应
    4. 历史数据查询与图表展示
  - 记录测试问题，创建Bug清单

- [x] **任务10.4：Bug修复与优化**
  - 修复测试发现的Bug
  - 优化前端界面细节（样式、布局、交互）
  - 优化后端性能（数据库查询、批量操作）
  - 优化模拟器稳定性
  - 完善错误处理与日志记录

#### 晚上任务 (2小时) - 可选
- [x] **任务10.5：项目部署准备**
  - 编写前端打包脚本 `npm run build`
  - 配置后端打包（Maven：`mvn clean package`）
  - 编写部署文档 `DEPLOY.md`
  - 编写用户操作手册 `USER_MANUAL.md`
  - 录制项目演示视频（5-10分钟）

---

## 📊 任务统计与工作量评估

### 开发任务分类
| 模块 | 任务数 | 预估工时 |
|------|--------|----------|
| 环境搭建 | 4 | 8小时 |
| Python模拟器 | 4 | 8小时 |
| 后端基础架构 | 6 | 12小时 |
| 后端业务逻辑 | 8 | 16小时 |
| 前端基础架构 | 4 | 8小时 |
| 前端页面开发 | 12 | 24小时 |
| 集成测试 | 2 | 4小时 |
| **总计** | **40** | **80小时** |

### 每日工作量
- **标准工作日**：8小时（上午4小时 + 下午4小时）
- **可选加班**：2小时（晚上）
- **两周总工时**：80小时（刚好符合两周工作量）

---

## 🎯 关键里程碑

| 时间点 | 里程碑 | 交付物 |
|--------|--------|--------|
| Day 2结束 | 模拟器完成 | 能够生成并发送传感器数据 |
| Day 5结束 | 后端核心功能完成 | API接口可用，能接收并处理数据 |
| Day 7结束 | 前端首页完成 | 实时监控界面可用，数据可视化 |
| Day 9结束 | 所有页面开发完成 | 前端功能完整 |
| Day 10结束 | 系统集成完成 | 端到端功能测试通过，可演示 |

---

## ⚠️ 风险预警与应对

### 高风险项
1. **虚拟串口/Socket通信不稳定**
   - 预留时间：Day 3下午
   - 备选方案：使用HTTP轮询代替实时通信

2. **WebSocket连接问题**
   - 预留时间：Day 4下午
   - 备选方案：使用HTTP长轮询

3. **ECharts图表性能问题**
   - 预留时间：Day 8下午
   - 优化方案：数据抽样、懒加载

### 时间缓冲
- 每天预留0.5小时处理意外问题
- Day 10下午专门用于Bug修复
- 可灵活调整任务优先级

---

## 📝 每日工作检查清单

### 开发规范
- [ ] 代码提交前进行自测
- [ ] 遵循Java/Python/TypeScript编码规范
- [ ] 添加必要的注释
- [ ] 每日至少一次Git提交
- [ ] 更新开发日志

### 测试规范
- [ ] 后端接口使用Postman测试
- [ ] 前端功能进行浏览器测试
- [ ] 记录并及时修复Bug
- [ ] 验证跨浏览器兼容性（Chrome、Firefox、Edge）

### 文档规范
- [ ] 更新API接口文档
- [ ] 记录重要决策和技术选型
- [ ] 编写关键模块的使用说明

---

## 🚀 快速启动指南

### 第一天快速启动
1. 克隆/创建Git仓库
2. 执行数据库初始化脚本
3. 配置后端项目
4. 运行后端测试，确保数据库连接成功

### 每日启动流程
1. 启动MySQL数据库
2. 启动后端服务（Spring Boot）
3. 启动Python模拟器
4. 启动前端开发服务器（npm run dev）
5. 打开浏览器访问 `http://localhost:5173`

---

## 📞 技术支持与协作

### 遇到问题时
1. 查阅官方文档
2. 搜索Stack Overflow
3. 查看项目需求分析文档
4. 记录问题到issues列表

### 代码审查
- 关键模块完成后进行代码审查
- 遵循代码审查checklist
- 重点检查：安全性、性能、可维护性

---

## ✅ 项目交付标准

### 代码质量
- [x] 无严重Bug
- [x] 核心功能完整实现
- [x] 代码符合规范
- [x] 必要的单元测试

### 文档完整性
- [x] 需求分析文档
- [x] 数据库设计文档
- [x] API接口文档
- [x] 部署文档
- [x] 用户操作手册

### 演示准备
- [x] 项目可正常启动
- [x] 准备演示数据
- [x] 录制演示视频
- [x] 准备PPT演讲稿

---

**祝开发顺利！🎉**

> 本计划为两周密集开发计划，每日任务已细化到具体功能点。建议严格按照计划执行，遇到问题及时调整。保持专注，保证质量，按时交付！
