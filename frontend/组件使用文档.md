# 公共组件使用文档

## 1. DataCard - 数据卡片组件

**用途**: 展示单个传感器数据或统计数据

**Props**:
- `title` (string, 必填): 卡片标题
- `value` (string | number, 必填): 数据值
- `unit` (string, 可选): 数据单位,如 "℃", "%", "ppm"
- `icon` (Component, 可选): 图标组件
- `iconColor` (string, 可选): 图标颜色,默认 "#409eff"
- `trend` (number, 可选): 趋势百分比,正数上升、负数下降、0持平

**使用示例**:
```vue
<template>
  <DataCard
    title="温度"
    :value="25.6"
    unit="℃"
    :icon="Sunny"
    iconColor="#f56c6c"
    :trend="5.2"
  />
</template>

<script setup lang="ts">
import DataCard from '@/components/DataCard.vue'
import { Sunny } from '@element-plus/icons-vue'
</script>
```

---

## 2. NodeStatus - 节点状态组件

**用途**: 显示ZigBee节点在线/离线状态

**Props**:
- `status` ('online' | 'offline' | 1 | 0, 必填): 节点状态
  - 'online' 或 1: 在线
  - 'offline' 或 0: 离线
- `showText` (boolean, 可选): 是否显示文字,默认 true

**特性**:
- 在线状态有呼吸动画效果
- 自动颜色标识(绿色在线、灰色离线)

**使用示例**:
```vue
<template>
  <NodeStatus :status="1" />
  <NodeStatus status="offline" />
  <NodeStatus :status="nodeInfo.nodeStatus" :show-text="false" />
</template>

<script setup lang="ts">
import NodeStatus from '@/components/NodeStatus.vue'
import { ref } from 'vue'

const nodeInfo = ref({ nodeStatus: 1 })
</script>
```

---

## 3. AlarmBadge - 报警徽章组件

**用途**: 显示报警级别标签

**Props**:
- `level` (1 | 2 | 3, 必填): 报警级别
  - 1: 低级报警(info)
  - 2: 中级报警(warning)
  - 3: 高级报警(danger)
- `size` ('large' | 'default' | 'small', 可选): 标签大小,默认 'default'
- `effect` ('dark' | 'light' | 'plain', 可选): 主题,默认 'light'

**使用示例**:
```vue
<template>
  <AlarmBadge :level="1" />
  <AlarmBadge :level="2" size="small" />
  <AlarmBadge :level="3" effect="dark" />
</template>

<script setup lang="ts">
import AlarmBadge from '@/components/AlarmBadge.vue'
</script>
```

---

## 4. DeviceSwitch - 设备开关组件

**用途**: 控制设备开关状态

**Props**:
- `deviceId` (number, 必填): 设备ID
- `deviceName` (string, 必填): 设备名称
- `status` (number, 必填): 设备状态(1-开启, 0-关闭)
- `mode` (number, 可选): 控制模式(1-自动, 2-手动),默认 2
- `showMode` (boolean, 可选): 是否显示模式标签,默认 false
- `disabled` (boolean, 可选): 是否禁用开关,默认 false

**事件**:
- `@control(deviceId: number, value: string)`: 开关变化时触发
  - deviceId: 设备ID
  - value: "on" 或 "off"

**特性**:
- 自动模式下无法手动控制
- 带加载状态
- 悬停效果

**使用示例**:
```vue
<template>
  <DeviceSwitch
    :device-id="1"
    device-name="通风机1"
    :status="1"
    :mode="2"
    :show-mode="true"
    @control="handleDeviceControl"
  />
</template>

<script setup lang="ts">
import DeviceSwitch from '@/components/DeviceSwitch.vue'
import { controlDevice } from '@/api/device'
import { ElMessage } from 'element-plus'

const handleDeviceControl = async (deviceId: number, value: string) => {
  try {
    await controlDevice({ deviceId, controlValue: value })
    ElMessage.success('设备控制成功')
  } catch (error) {
    ElMessage.error('设备控制失败')
  }
}
</script>
```

---

## 综合使用示例

```vue
<template>
  <div class="dashboard">
    <!-- 数据卡片展示 -->
    <el-row :gutter="20">
      <el-col :span="6">
        <DataCard
          title="温度"
          :value="sensorData.temperature"
          unit="℃"
          :icon="Sunny"
          iconColor="#f56c6c"
          :trend="2.5"
        />
      </el-col>
      <el-col :span="6">
        <DataCard
          title="湿度"
          :value="sensorData.humidity"
          unit="%"
          :icon="Drizzling"
          iconColor="#409eff"
          :trend="-1.2"
        />
      </el-col>
    </el-row>

    <!-- 节点状态列表 -->
    <el-table :data="nodeList">
      <el-table-column prop="nodeName" label="节点名称" />
      <el-table-column label="状态">
        <template #default="{ row }">
          <NodeStatus :status="row.nodeStatus" />
        </template>
      </el-table-column>
    </el-table>

    <!-- 报警列表 -->
    <el-table :data="alarmList">
      <el-table-column prop="alarmContent" label="报警内容" />
      <el-table-column label="级别">
        <template #default="{ row }">
          <AlarmBadge :level="row.alarmLevel" />
        </template>
      </el-table-column>
    </el-table>

    <!-- 设备控制 -->
    <div class="device-controls">
      <DeviceSwitch
        v-for="device in deviceList"
        :key="device.id"
        :device-id="device.id"
        :device-name="device.deviceName"
        :status="device.deviceStatus"
        :mode="device.controlMode"
        show-mode
        @control="handleDeviceControl"
      />
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import DataCard from '@/components/DataCard.vue'
import NodeStatus from '@/components/NodeStatus.vue'
import AlarmBadge from '@/components/AlarmBadge.vue'
import DeviceSwitch from '@/components/DeviceSwitch.vue'
import { Sunny, Drizzling } from '@element-plus/icons-vue'

const sensorData = ref({ temperature: 25.6, humidity: 68.3 })
const nodeList = ref([])
const alarmList = ref([])
const deviceList = ref([])

const handleDeviceControl = async (deviceId: number, value: string) => {
  // 实现设备控制逻辑
}
</script>
```
